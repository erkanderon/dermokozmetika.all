define(["vendors/jquery.$$.min","vendors/jquery.min","vendors/jquery-loading.min","vendors/jquery-validate.min","vendors/underscore.min"],{elements:{$block:"#newsletter-cover-block",$close:"#newsletter-cover-block .close",$btn:"#newsletter-cover-block .btn",$form:"#newsletter-cover-block form"},events:{close:function(){$$(blocks.covers.newsletter.elements.$block).hide(),$$("html").removeClass("has-newsletter-cover-block"),document.cookie="subscription=true"},form:function(e){return $.ajax(_.extend(blocks.covers.newsletter.requests.subscribe,{beforeSend:function(){return $$(blocks.covers.newsletter.elements.$btn).loading()},complete:function(){return $$(blocks.covers.newsletter.elements.$btn).loading("hide")},data:$$(e).serializeObject(),success:function(e){return 1===e.status?new Noty({layout:"bottomCenter",text:"E-posta adresiniz başarıyla kaydedildi.",theme:"bootstrap-v4",type:"success"}).show():new Noty({layout:"bottomCenter",text:"E-posta adresiniz başarıyla kaydedilmedi.",theme:"bootstrap-v4",type:"error"}).show(),$$(blocks.covers.newsletter.elements.$close).trigger("click")}})),!1}},getCookie:function(e){var t,s,o,r;for(r=e+"=",s=decodeURIComponent(document.cookie).split(";"),o=0;o<s.length;){for(t=s[o];" "===t.charAt(0);)t=t.substring(1);if(0===t.indexOf(r))return t.substring(r.length,t.length);o++}return""},init:function(){""===this.getCookie("subscription")?($$(this.elements.$block).show(),$$(this.elements.$close).on("click",this.events.close),$$(this.elements.$form).validate({submitHandler:blocks.covers.newsletter.events.form})):$$("html").removeClass("has-newsletter-cover-block")},requests:{subscribe:{dataType:"json",type:"post",url:"/srv/service/guest/subscribeNewsletter"}}});