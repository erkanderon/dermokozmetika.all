define(["vendors/bootstrap-select.min","vendors/jquery-validate.min","vendors/underscore.min"],{data:{validate:{submitHandler:function(e){return blocks.sections.register.events.form(e),!1}}},events:{form:function(e){return $.ajax($.extend(blocks.sections.register.requests.save,{data:$(e).serializeArray()}))}},init:function(){return this.data.is_logged&&$.ajax($.extend(blocks.sections.register.requests.get,{success:function(e){return _.each(e,function(e,t){return $("#register-section-block-form").find('[name="'+t+'"]').val(e)})}},$("#register-section-block-form").on("change",function(){return $("#register-section-block-btn").removeAttr("disabled")}))),$("#register-section-block-form").find("select[multiple]").selectpicker({noneSelectedText:"Seçiniz",iconBase:"fa",showTick:!0,tickIcon:"fa-check"}),this.validate=$("#register-section-block-form").validate(this.data.validate)},requests:{get:{dataType:"json",url:"/srv/service/customer/get-detail"},save:{beforeSend:function(){return $("#register-section-block-btn").loading()},complete:function(){return $("#register-section-block-btn").loading("hide")},dataType:"json",success:function(e){var t;return blocks.sections.register.data.is_logged?(new Noty({layout:"bottomCenter",text:"Üyelik bilgileriniz başarıyla güncellendi.",theme:"bootstrap-v4",type:"success"}).show(),$("#register-section-block-btn").attr("disabled",!0)):e.status?(fbq("track","CompleteRegistration"),new Noty({callbacks:{afterClose:function(){return location.href="/"}},layout:"bottomCenter",text:e.statusText,theme:"bootstrap-v4",type:"success"}).show(),$("#register-section-block-btn").attr("disabled",!0)):blocks.sections.register.validate.showErrors((t={},t[""+e.key]=e.statusText,t))},type:"post",url:"/srv/service/customer/save"}}});